# Function to get and display Active Directory password policy
function Display-ADPasswordPolicy {
    Write-Host "Fetching Active Directory Password Policy..." -ForegroundColor Cyan

    # Import Active Directory module (ensure it's installed)
    Import-Module ActiveDirectory -ErrorAction Stop

    # Retrieve the default domain password policy
    $passwordPolicy = Get-ADDefaultDomainPasswordPolicy

    # Display the policies
    Write-Host "Active Directory Password Policy Details:" -ForegroundColor Yellow
    Write-Host "-----------------------------------------"
    Write-Host "Minimum Password Length         : $($passwordPolicy.MinPasswordLength)"
    Write-Host "Password Complexity Required    : $($passwordPolicy.PasswordComplexity)"
    Write-Host "Minimum Password Age (days)     : $($passwordPolicy.MinPasswordAge.TotalDays)"
    Write-Host "Maximum Password Age (days)     : $($passwordPolicy.MaxPasswordAge.TotalDays)"
    Write-Host "Lockout Threshold               : $($passwordPolicy.LockoutThreshold)"
    Write-Host "Lockout Duration (minutes)      : $($passwordPolicy.LockoutDuration.TotalMinutes)"
    Write-Host "Observation Window (minutes)    : $($passwordPolicy.LockoutObservationWindow.TotalMinutes)"
    Write-Host "-----------------------------------------"
}

# Run the function
Display-ADPasswordPolicy
